<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Thiyanga S. Talagala   Department of Statistics, Faculty of Applied Sciences   University of Sri Jayewardenepura, Sri Lanka">

<title>DSA 554 3.0 Spatio-temporal Data Analysis – web</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">web</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#kriging-vs-idw" id="toc-kriging-vs-idw" class="nav-link active" data-scroll-target="#kriging-vs-idw">Kriging vs IDW</a></li>
  <li><a href="#weight-determination-in-kriging" id="toc-weight-determination-in-kriging" class="nav-link" data-scroll-target="#weight-determination-in-kriging">Weight Determination in Kriging</a></li>
  <li><a href="#comparison-of-weight-selection-in-kriging-and-idw" id="toc-comparison-of-weight-selection-in-kriging-and-idw" class="nav-link" data-scroll-target="#comparison-of-weight-selection-in-kriging-and-idw">Comparison of Weight Selection in Kriging and IDW</a></li>
  <li><a href="#key-points" id="toc-key-points" class="nav-link" data-scroll-target="#key-points">Key points</a></li>
  <li><a href="#variograms" id="toc-variograms" class="nav-link" data-scroll-target="#variograms">Variograms</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a></li>
  <li><a href="#convert-to-spatial-object-method-1" id="toc-convert-to-spatial-object-method-1" class="nav-link" data-scroll-target="#convert-to-spatial-object-method-1">Convert to Spatial Object: Method 1</a></li>
  <li><a href="#spatial-extent" id="toc-spatial-extent" class="nav-link" data-scroll-target="#spatial-extent">Spatial Extent</a></li>
  <li><a href="#lagged-scatterplot" id="toc-lagged-scatterplot" class="nav-link" data-scroll-target="#lagged-scatterplot">Lagged Scatterplot</a></li>
  <li><a href="#lagged-scatterplot-1" id="toc-lagged-scatterplot-1" class="nav-link" data-scroll-target="#lagged-scatterplot-1">Lagged Scatterplot</a></li>
  <li><a href="#steps-to-construct-a-lagged-scatterplot-for-spatial-analysis" id="toc-steps-to-construct-a-lagged-scatterplot-for-spatial-analysis" class="nav-link" data-scroll-target="#steps-to-construct-a-lagged-scatterplot-for-spatial-analysis">Steps to Construct a Lagged Scatterplot for Spatial Analysis</a></li>
  <li><a href="#example-of-selecting-lag-distance" id="toc-example-of-selecting-lag-distance" class="nav-link" data-scroll-target="#example-of-selecting-lag-distance">Example of Selecting Lag Distance</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a>
  <ul class="collapse">
  <li><a href="#the-reason-for-the-transition-from-an-h-scatterplot-to-a-variogram-cloud" id="toc-the-reason-for-the-transition-from-an-h-scatterplot-to-a-variogram-cloud" class="nav-link" data-scroll-target="#the-reason-for-the-transition-from-an-h-scatterplot-to-a-variogram-cloud">The reason for The transition from an h-scatterplot to a variogram cloud</a></li>
  <li><a href="#variogram-cloud" id="toc-variogram-cloud" class="nav-link" data-scroll-target="#variogram-cloud">Variogram Cloud</a></li>
  <li><a href="#binned-variogram" id="toc-binned-variogram" class="nav-link" data-scroll-target="#binned-variogram">Binned Variogram</a></li>
  <li><a href="#improving-the-interpretation-of-spatial-structure" id="toc-improving-the-interpretation-of-spatial-structure" class="nav-link" data-scroll-target="#improving-the-interpretation-of-spatial-structure">Improving the Interpretation of Spatial Structure</a></li>
  <li><a href="#reading" id="toc-reading" class="nav-link" data-scroll-target="#reading">Reading</a></li>
  <li><a href="#interpretations-of-variograms" id="toc-interpretations-of-variograms" class="nav-link" data-scroll-target="#interpretations-of-variograms">Interpretations of Variograms</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#relationship-between-a-correlogram-and-a-variogram" id="toc-relationship-between-a-correlogram-and-a-variogram" class="nav-link" data-scroll-target="#relationship-between-a-correlogram-and-a-variogram">Relationship between a correlogram and a variogram</a></li>
  <li><a href="#acknowledgement" id="toc-acknowledgement" class="nav-link" data-scroll-target="#acknowledgement">Acknowledgement</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSA 554 3.0 Spatio-temporal Data Analysis</h1>
<p class="subtitle lead">Kriging and Variograms</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Thiyanga S. Talagala <br> Department of Statistics, Faculty of Applied Sciences <br> University of Sri Jayewardenepura, Sri Lanka </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="kriging-vs-idw" class="level2">
<h2 class="anchored" data-anchor-id="kriging-vs-idw">Kriging vs IDW</h2>
<ul>
<li><p>Inverse Distance Weighting (IDW) and Kriging are weighted methods for interpolation. The key difference lies in how they determine and apply weights.</p></li>
<li><p>In IDW, weights are determined solely based on distance between the point being estimated and the known sample points.</p>
<ul>
<li><p>Nearby points have greater influence (higher weights) than distant points.</p></li>
<li><p>The weights are purely geometric and ignore any statistical relationships or spatial trends in the data.</p></li>
</ul></li>
<li><p>Kriging determines weights based on both the distance between points and the spatial autocorrelation of the data, which is modeled using a semivariogram. The semivariogram quantifies how similar data values are based on their separation distance.</p></li>
</ul>
</section>
<section id="weight-determination-in-kriging" class="level2">
<h2 class="anchored" data-anchor-id="weight-determination-in-kriging">Weight Determination in Kriging</h2>
<ul>
<li><p>Kriging solves a system of linear equations derived from the semivariogram, minimizing prediction variance while ensuring unbiasedness.</p></li>
<li><p>Weights are chosen such that they account for:</p>
<p>Distances: Between the interpolation point and sample points.</p>
<p>Spatial relationships: Among the sample points themselves (accounting for clustering and redundancy).</p></li>
<li><p>Weights depend on the semivariogram model (e.g., spherical, exponential). Points farther away can still have influence if the semivariogram indicates spatial continuity.</p></li>
</ul>
</section>
<section id="comparison-of-weight-selection-in-kriging-and-idw" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-weight-selection-in-kriging-and-idw">Comparison of Weight Selection in Kriging and IDW</h2>
<p>In-class explanation</p>
</section>
<section id="key-points" class="level2">
<h2 class="anchored" data-anchor-id="key-points">Key points</h2>
<ul>
<li><p>IDW is straightforward, where weights depend only on how close a point is to the location being estimated. It assumes all variation is captured by distance.</p></li>
<li><p>Kriging uses a more sophisticated approach, accounting for both distance and how sample points are spatially correlated, providing more accurate and statistically sound estimates in many cases</p></li>
</ul>
</section>
<section id="variograms" class="level2">
<h2 class="anchored" data-anchor-id="variograms">Variograms</h2>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gstat)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>no2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">system.file</span>(<span class="st">"external/no2.csv"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">package =</span> <span class="st">"gstat"</span>), <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>no2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 74 × 21
   station_european_code station_local_code country_iso_code country_name
   &lt;chr&gt;                 &lt;chr&gt;              &lt;chr&gt;            &lt;chr&gt;       
 1 DENI063               DENI063            DE               Germany     
 2 DEBY109               DEBY109            DE               Germany     
 3 DEBE056               DEBE056            DE               Germany     
 4 DEBE062               DEBE062            DE               Germany     
 5 DEBE032               DEBE032            DE               Germany     
 6 DEHE046               DEHE046            DE               Germany     
 7 DEBY122               DEBY122            DE               Germany     
 8 DESL019               DESL019            DE               Germany     
 9 DENW081               DENW081            DE               Germany     
10 DESH008               DESH008            DE               Germany     
# ℹ 64 more rows
# ℹ 17 more variables: station_name &lt;chr&gt;, station_start_date &lt;date&gt;,
#   station_end_date &lt;lgl&gt;, type_of_station &lt;chr&gt;,
#   station_ozone_classification &lt;chr&gt;, station_type_of_area &lt;chr&gt;,
#   station_subcat_rural_back &lt;chr&gt;, street_type &lt;chr&gt;,
#   station_longitude_deg &lt;dbl&gt;, station_latitude_deg &lt;dbl&gt;,
#   station_altitude &lt;dbl&gt;, station_city &lt;chr&gt;, lau_level1_code &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="convert-to-spatial-object-method-1" class="level2">
<h2 class="anchored" data-anchor-id="convert-to-spatial-object-method-1">Convert to Spatial Object: Method 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>crs <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(<span class="st">"EPSG:32632"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>no2.sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(no2, <span class="at">crs =</span> <span class="st">"OGC:CRS84"</span>, <span class="at">coords =</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"station_longitude_deg"</span>, <span class="st">"station_latitude_deg"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(crs) </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>no2.sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 74 features and 19 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 304638.2 ymin: 5263687 xmax: 900829.7 ymax: 6086661
Projected CRS: WGS 84 / UTM zone 32N
# A tibble: 74 × 20
   station_european_code station_local_code country_iso_code country_name
 * &lt;chr&gt;                 &lt;chr&gt;              &lt;chr&gt;            &lt;chr&gt;       
 1 DENI063               DENI063            DE               Germany     
 2 DEBY109               DEBY109            DE               Germany     
 3 DEBE056               DEBE056            DE               Germany     
 4 DEBE062               DEBE062            DE               Germany     
 5 DEBE032               DEBE032            DE               Germany     
 6 DEHE046               DEHE046            DE               Germany     
 7 DEBY122               DEBY122            DE               Germany     
 8 DESL019               DESL019            DE               Germany     
 9 DENW081               DENW081            DE               Germany     
10 DESH008               DESH008            DE               Germany     
# ℹ 64 more rows
# ℹ 16 more variables: station_name &lt;chr&gt;, station_start_date &lt;date&gt;,
#   station_end_date &lt;lgl&gt;, type_of_station &lt;chr&gt;,
#   station_ozone_classification &lt;chr&gt;, station_type_of_area &lt;chr&gt;,
#   station_subcat_rural_back &lt;chr&gt;, street_type &lt;chr&gt;, station_altitude &lt;dbl&gt;,
#   station_city &lt;chr&gt;, lau_level1_code &lt;dbl&gt;, lau_level2_code &lt;dbl&gt;,
#   lau_level2_name &lt;chr&gt;, EMEP_station &lt;chr&gt;, NO2 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="spatial-extent" class="level2">
<h2 class="anchored" data-anchor-id="spatial-extent">Spatial Extent</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     xmin      ymin      xmax      ymax 
 304638.2 5263687.2  900829.7 6086661.1 </code></pre>
</div>
</div>
</section>
<section id="lagged-scatterplot" class="level2">
<h2 class="anchored" data-anchor-id="lagged-scatterplot">Lagged Scatterplot</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lagged-scatterplot-1" class="level2">
<h2 class="anchored" data-anchor-id="lagged-scatterplot-1">Lagged Scatterplot</h2>
<p>In spatial analysis, a lagged scatterplot explores spatial autocorrelation by plotting the values of a variable at locations separated by a specific lag distance. It is used to assess how the similarity of values changes with distance, helping understand spatial patterns and dependencies.</p>
</section>
<section id="steps-to-construct-a-lagged-scatterplot-for-spatial-analysis" class="level2">
<h2 class="anchored" data-anchor-id="steps-to-construct-a-lagged-scatterplot-for-spatial-analysis">Steps to Construct a Lagged Scatterplot for Spatial Analysis</h2>
<ol type="1">
<li><p>Define the Variable of Interest Choose the variable whose spatial relationship you want to analyze (e.g., air pollution levels, rainfall, temperature, etc.).</p></li>
<li><p>Select a Lag Distance Decide the distance intervals (lags) at which you want to compare the values. For example:</p></li>
</ol>
<p>0–1000 meters</p>
<p>1000–2000 meters</p>
<p>2000–3000 meters</p>
<ol start="3" type="1">
<li><p>Pair Locations Based on Lag Identify all pairs of points whose separation distance falls within each lag interval.</p></li>
<li><p>Calculate Values</p></li>
</ol>
<p>For each pair of points:</p>
<p>Plot the value at one location on the x-axis.</p>
<p>Plot the value at the paired location on the y-axis.</p>
<ol start="5" type="1">
<li>Visualize Create a scatterplot for each lag interval to observe spatial relationships.</li>
</ol>
</section>
<section id="example-of-selecting-lag-distance" class="level2">
<h2 class="anchored" data-anchor-id="example-of-selecting-lag-distance">Example of Selecting Lag Distance</h2>
<p>Let’s say you have a dataset of air quality measurements in a city, and you want to analyze the spatial relationship between stations. Here’s how you might proceed:</p>
<p>Examine the study area: If your data spans an area of 10 km by 10 km, then a lag distance of 500 meters or 1 km might be reasonable.</p>
<p>Check for spatial autocorrelation: Create a variogram to see how the data correlates over distances. You’ll likely see that values are highly correlated at short distances (e.g., 100–500 meters) but become less correlated as the distance grows.</p>
<p>Set lag intervals: Based on your variogram and knowledge, you might decide on breaks such as:</p>
<p>0–500 meters</p>
<p>500–1000 meters</p>
<p>1000–2000 meters</p>
<p>2000–5000 meters</p>
<p>Adjust based on the data: If you find that most of your points are clustered closely together, you may select smaller lags. If the points are spread out, you may select larger lags.</p>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="section-3" class="level1">
<h1></h1>
<p><a href="https://thiyangt.github.io/spatial-modelling/#/investigate-spatial-autocorrelation-using-empirical-variogram-variogram-cloud">https://thiyangt.github.io/spatial-modelling/#/investigate-spatial-autocorrelation-using-empirical-variogram-variogram-cloud</a></p>
<section id="the-reason-for-the-transition-from-an-h-scatterplot-to-a-variogram-cloud" class="level2">
<h2 class="anchored" data-anchor-id="the-reason-for-the-transition-from-an-h-scatterplot-to-a-variogram-cloud">The reason for The transition from an h-scatterplot to a variogram cloud</h2>
<p>h-Scatterplot: This plot shows the relationship between values of a variable at different distances (lags) in a scatterplot format. While it is useful to get a rough idea of the spatial relationship, it doesn’t provide a detailed understanding of how spatial dependence varies with distance.</p>
<p>Variogram Cloud: The variogram cloud (or experimental variogram) provides a more refined and systematic view of spatial dependence. It plots the variance of the differences between values at pairs of locations (the semivariance) against the distance between those locations.</p>
</section>
<section id="variogram-cloud" class="level2">
<h2 class="anchored" data-anchor-id="variogram-cloud">Variogram Cloud</h2>
<p>A variogram cloud shows the semivariance for every pair of spatial locations in the dataset, at different distances (lags). It provides valuable information, but it can be noisy, especially in large datasets. Each point in the cloud represents a pair of points at a specific distance, but there may be a lot of variability due to:</p>
<p>Sampling errors,</p>
<p>Data sparsity in certain ranges,</p>
<p>Local irregularities.</p>
<p>This noise can make it harder to interpret the spatial structure of the data clearly.</p>
</section>
<section id="binned-variogram" class="level2">
<h2 class="anchored" data-anchor-id="binned-variogram">Binned Variogram</h2>
<p>To address this, the variogram cloud is often binned into predefined distance intervals (lags). This process groups the semivariance values for pairs of points that fall within certain distance ranges, effectively averaging them. This reduces the noise and results in a smoother, more stable variogram. The binned variogram provides a clearer representation of the overall trend in spatial autocorrelation, particularly for larger datasets.</p>
</section>
<section id="improving-the-interpretation-of-spatial-structure" class="level2">
<h2 class="anchored" data-anchor-id="improving-the-interpretation-of-spatial-structure">Improving the Interpretation of Spatial Structure</h2>
<p><strong>Variogram Cloud:</strong> The cloud may contain too many points to easily discern patterns or trends in the spatial structure. The relationship between distance and semivariance may be obscured by the sheer number of points and their variability.</p>
<p><strong>Binned Variogram:</strong> By binning the data, you get a smoothed representation of how semivariance increases with distance. This makes it easier to identify key features of the spatial structure, such as:</p>
<p><strong>The range:</strong> The distance at which spatial dependence effectively disappears.</p>
<p><strong>The nugget effect:</strong> The value of the semivariance at very short distances, indicating local variability or measurement error.</p>
<p><strong>The sill:</strong> The maximum value of the semivariance, beyond which no further increase in variability is observed.</p>
<p>The binned variogram helps in understanding the overall trend in the spatial dependence between locations.</p>
</section>
<section id="reading" class="level2">
<h2 class="anchored" data-anchor-id="reading">Reading</h2>
<p><a href="https://scikit-gstat.readthedocs.io/en/latest/userguide/variogram.html">https://scikit-gstat.readthedocs.io/en/latest/userguide/variogram.html</a></p>
</section>
<section id="interpretations-of-variograms" class="level2">
<h2 class="anchored" data-anchor-id="interpretations-of-variograms">Interpretations of Variograms</h2>
<p><span class="math display">\[C(h) = Sill - \gamma(h)\]</span></p>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
<p><img src="dia1.png" class="img-fluid"></p>
</section>
<section id="relationship-between-a-correlogram-and-a-variogram" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-a-correlogram-and-a-variogram">Relationship between a correlogram and a variogram</h2>
<p>In class explanations</p>
<p>Further reading: https://csegrecorder.com/articles/view/the-variogram-basics-a-visual-intro-to-useful-geostatistical-concepts</p>
</section>
<section id="acknowledgement" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgement">Acknowledgement</h2>
<p><a href="https://r-spatial.org/book/12-Interpolation.html">https://r-spatial.org/book/12-Interpolation.html</a></p>


</section>
</section>

</main> <!-- /main -->


<script>

  // htmlwidgets need to know to resize themselves when slides are shown/hidden.

  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

  // slide changes (different for each slide format).

  (function () {

    // dispatch for htmlwidgets

    function fireSlideEnter() {

      const event = window.document.createEvent("Event");

      event.initEvent("slideenter", true, true);

      window.document.dispatchEvent(event);

    }



    function fireSlideChanged(previousSlide, currentSlide) {

      fireSlideEnter();



      // dispatch for shiny

      if (window.jQuery) {

        if (previousSlide) {

          window.jQuery(previousSlide).trigger("hidden");

        }

        if (currentSlide) {

          window.jQuery(currentSlide).trigger("shown");

        }

      }

    }



    // hookup for slidy

    if (window.w3c_slidy) {

      window.w3c_slidy.add_observer(function (slide_num) {

        // slide_num starts at position 1

        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

      });

    }



  })();

</script>



<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>