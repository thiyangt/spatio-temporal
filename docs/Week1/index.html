<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Thiyanga S. Talagala   Department of Statistics, Faculty of Applied Sciences   University of Sri Jayewardenepura, Sri Lanka">

<title>DSA 554 3.0 Spatio-temporal Data Analysis â€“ web</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">web</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#time-series" id="toc-time-series" class="nav-link active" data-scroll-target="#time-series">Time Series</a>
  <ul class="collapse">
  <li><a href="#cross-sectional-data" id="toc-cross-sectional-data" class="nav-link" data-scroll-target="#cross-sectional-data">Cross sectional data</a></li>
  <li><a href="#time-series-data" id="toc-time-series-data" class="nav-link" data-scroll-target="#time-series-data">Time series data</a></li>
  </ul></li>
  <li><a href="#time-series-patterns" id="toc-time-series-patterns" class="nav-link" data-scroll-target="#time-series-patterns">Time Series Patterns</a>
  <ul class="collapse">
  <li><a href="#trend" id="toc-trend" class="nav-link" data-scroll-target="#trend">Trend</a></li>
  <li><a href="#seasonal" id="toc-seasonal" class="nav-link" data-scroll-target="#seasonal">Seasonal</a></li>
  <li><a href="#cyclic" id="toc-cyclic" class="nav-link" data-scroll-target="#cyclic">Cyclic</a></li>
  <li><a href="#frequency-of-a-time-series-seasonal-periods" id="toc-frequency-of-a-time-series-seasonal-periods" class="nav-link" data-scroll-target="#frequency-of-a-time-series-seasonal-periods">Frequency of a time series: Seasonal periods</a></li>
  <li><a href="#multiple-seasonal-patterns" id="toc-multiple-seasonal-patterns" class="nav-link" data-scroll-target="#multiple-seasonal-patterns">Multiple Seasonal Patterns</a></li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn">Your turn</a></li>
  </ul></li>
  <li><a href="#correlation-vs-autocorrelation" id="toc-correlation-vs-autocorrelation" class="nav-link" data-scroll-target="#correlation-vs-autocorrelation">Correlation vs Autocorrelation</a>
  <ul class="collapse">
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  <li><a href="#autocorrelation" id="toc-autocorrelation" class="nav-link" data-scroll-target="#autocorrelation">Autocorrelation</a></li>
  <li><a href="#autocorrelation-plot" id="toc-autocorrelation-plot" class="nav-link" data-scroll-target="#autocorrelation-plot">Autocorrelation plot</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example 1</a></li>
  <li><a href="#example-1-cont." id="toc-example-1-cont." class="nav-link" data-scroll-target="#example-1-cont.">Example 1 (cont.)</a></li>
  <li><a href="#example-1-cont.-1" id="toc-example-1-cont.-1" class="nav-link" data-scroll-target="#example-1-cont.-1">Example 1 (cont.)</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example 2</a></li>
  <li><a href="#example-2cont." id="toc-example-2cont." class="nav-link" data-scroll-target="#example-2cont.">Example 2(cont.)</a></li>
  <li><a href="#example-2-cont." id="toc-example-2-cont." class="nav-link" data-scroll-target="#example-2-cont.">Example 2 (cont.)</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example 3</a></li>
  <li><a href="#example-3-cont" id="toc-example-3-cont" class="nav-link" data-scroll-target="#example-3-cont">Example 3 (cont)</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation">Notation</a></li>
  <li><a href="#simple-time-series-forecasting-techniques" id="toc-simple-time-series-forecasting-techniques" class="nav-link" data-scroll-target="#simple-time-series-forecasting-techniques">Simple time series forecasting techniques</a></li>
  <li><a href="#electricity-demand" id="toc-electricity-demand" class="nav-link" data-scroll-target="#electricity-demand">Electricity Demand</a></li>
  </ul></li>
  <li><a href="#statistical-properties" id="toc-statistical-properties" class="nav-link" data-scroll-target="#statistical-properties">Statistical Properties</a>
  <ul class="collapse">
  <li><a href="#mean-function" id="toc-mean-function" class="nav-link" data-scroll-target="#mean-function">Mean function</a></li>
  <li><a href="#covariance-function" id="toc-covariance-function" class="nav-link" data-scroll-target="#covariance-function">Covariance function</a></li>
  <li><a href="#autocovariance-function" id="toc-autocovariance-function" class="nav-link" data-scroll-target="#autocovariance-function">Autocovariance function</a></li>
  <li><a href="#weekly-stationary" id="toc-weekly-stationary" class="nav-link" data-scroll-target="#weekly-stationary">Weekly stationary</a></li>
  <li><a href="#strict-stationarity-of-a-time-series" id="toc-strict-stationarity-of-a-time-series" class="nav-link" data-scroll-target="#strict-stationarity-of-a-time-series">Strict stationarity of a time series</a></li>
  </ul></li>
  <li><a href="#simple-time-series-models" id="toc-simple-time-series-models" class="nav-link" data-scroll-target="#simple-time-series-models">Simple time series models</a>
  <ul class="collapse">
  <li><a href="#iid-noise" id="toc-iid-noise" class="nav-link" data-scroll-target="#iid-noise">1. iid noise</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#white-noise" id="toc-white-noise" class="nav-link" data-scroll-target="#white-noise">2. White noise</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#acf" id="toc-acf" class="nav-link" data-scroll-target="#acf">ACF</a></li>
  <li><a href="#random-walk" id="toc-random-walk" class="nav-link" data-scroll-target="#random-walk">3. Random walk</a></li>
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question">Question</a></li>
  <li><a href="#identifying-non-stationarity-in-the-mean" id="toc-identifying-non-stationarity-in-the-mean" class="nav-link" data-scroll-target="#identifying-non-stationarity-in-the-mean">Identifying non-stationarity in the mean</a></li>
  </ul></li>
  <li><a href="#elimination-of-trend-and-seasonality-by-differencing" id="toc-elimination-of-trend-and-seasonality-by-differencing" class="nav-link" data-scroll-target="#elimination-of-trend-and-seasonality-by-differencing">Elimination of Trend and Seasonality by Differencing</a>
  <ul class="collapse">
  <li><a href="#backshift-notation" id="toc-backshift-notation" class="nav-link" data-scroll-target="#backshift-notation">Backshift notation:</a></li>
  <li><a href="#ordinary-differencing" id="toc-ordinary-differencing" class="nav-link" data-scroll-target="#ordinary-differencing">Ordinary differencing</a></li>
  <li><a href="#seasonal-differencing" id="toc-seasonal-differencing" class="nav-link" data-scroll-target="#seasonal-differencing">Seasonal differencing</a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#non-stationary-time-series" id="toc-non-stationary-time-series" class="nav-link" data-scroll-target="#non-stationary-time-series">Non-Stationary Time Series</a></li>
  <li><a href="#non-stationary-time-series-cont." id="toc-non-stationary-time-series-cont." class="nav-link" data-scroll-target="#non-stationary-time-series-cont.">Non-Stationary Time Series (cont.)</a></li>
  <li><a href="#non-stationary-time-series-cont.-1" id="toc-non-stationary-time-series-cont.-1" class="nav-link" data-scroll-target="#non-stationary-time-series-cont.-1">Non-Stationary Time Series (cont.)</a></li>
  <li><a href="#random-walk-1" id="toc-random-walk-1" class="nav-link" data-scroll-target="#random-walk-1">Random walk</a></li>
  <li><a href="#random-walk-with-drift" id="toc-random-walk-with-drift" class="nav-link" data-scroll-target="#random-walk-with-drift">Random walk with drift</a></li>
  <li><a href="#random-walk-with-drift-cont." id="toc-random-walk-with-drift-cont." class="nav-link" data-scroll-target="#random-walk-with-drift-cont.">Random walk with drift (cont.)</a></li>
  <li><a href="#common-trend-removal-de-trending-procedures" id="toc-common-trend-removal-de-trending-procedures" class="nav-link" data-scroll-target="#common-trend-removal-de-trending-procedures">Common trend removal (de-trending) procedures</a></li>
  </ul></li>
  <li><a href="#notation-id" id="toc-notation-id" class="nav-link" data-scroll-target="#notation-id">Notation: I(d)</a>
  <ul class="collapse">
  <li><a href="#random-walk-2" id="toc-random-walk-2" class="nav-link" data-scroll-target="#random-walk-2">Random walk</a></li>
  <li><a href="#random-walk---acf" id="toc-random-walk---acf" class="nav-link" data-scroll-target="#random-walk---acf">Random walk - ACF</a></li>
  <li><a href="#difference-series" id="toc-difference-series" class="nav-link" data-scroll-target="#difference-series">Difference series</a></li>
  <li><a href="#plot-lag-1-series" id="toc-plot-lag-1-series" class="nav-link" data-scroll-target="#plot-lag-1-series">Plot Lag 1 series</a></li>
  <li><a href="#acf-lag-1-series" id="toc-acf-lag-1-series" class="nav-link" data-scroll-target="#acf-lag-1-series">ACF Lag 1 series</a></li>
  <li><a href="#example-2-1" id="toc-example-2-1" class="nav-link" data-scroll-target="#example-2-1">Example 2</a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#nd-order-differencing" id="toc-nd-order-differencing" class="nav-link" data-scroll-target="#nd-order-differencing">2nd order differencing</a></li>
  <li><a href="#variance-stabilization" id="toc-variance-stabilization" class="nav-link" data-scroll-target="#variance-stabilization">Variance stabilization</a></li>
  <li><a href="#monthly-airline-passenger-numbers-1949-1960" id="toc-monthly-airline-passenger-numbers-1949-1960" class="nav-link" data-scroll-target="#monthly-airline-passenger-numbers-1949-1960">Monthly Airline Passenger Numbers 1949-1960</a></li>
  <li><a href="#monthly-airline-passenger-numbers-1949-1960---log" id="toc-monthly-airline-passenger-numbers-1949-1960---log" class="nav-link" data-scroll-target="#monthly-airline-passenger-numbers-1949-1960---log">Monthly Airline Passenger Numbers 1949-1960 - log</a></li>
  <li><a href="#box-cox-transformation" id="toc-box-cox-transformation" class="nav-link" data-scroll-target="#box-cox-transformation">Box-Cox transformation</a></li>
  <li><a href="#box-cox-transformation-1" id="toc-box-cox-transformation-1" class="nav-link" data-scroll-target="#box-cox-transformation-1">Box-Cox transformation</a></li>
  <li><a href="#box-cox-transformation-exploring-the-output" id="toc-box-cox-transformation-exploring-the-output" class="nav-link" data-scroll-target="#box-cox-transformation-exploring-the-output">Box-Cox transformation: Exploring the output</a></li>
  </ul></li>
  <li><a href="#linear-time-series-analysis" id="toc-linear-time-series-analysis" class="nav-link" data-scroll-target="#linear-time-series-analysis">Linear Time Series Analysis</a>
  <ul class="collapse">
  <li><a href="#autoregressive-models" id="toc-autoregressive-models" class="nav-link" data-scroll-target="#autoregressive-models">Autoregressive Models</a></li>
  <li><a href="#in-class-properties-of-ar1-process" id="toc-in-class-properties-of-ar1-process" class="nav-link" data-scroll-target="#in-class-properties-of-ar1-process">In-class: Properties of AR(1) process</a></li>
  <li><a href="#in-class-properties-of-ar2-process" id="toc-in-class-properties-of-ar2-process" class="nav-link" data-scroll-target="#in-class-properties-of-ar2-process">In-class: Properties of AR(2) process</a></li>
  <li><a href="#in-class-properties-of-arp-process" id="toc-in-class-properties-of-arp-process" class="nav-link" data-scroll-target="#in-class-properties-of-arp-process">In-class: Properties of AR(P) process</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSA 554 3.0 Spatio-temporal Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Thiyanga S. Talagala <br> Department of Statistics, Faculty of Applied Sciences <br> University of Sri Jayewardenepura, Sri Lanka </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="time-series" class="level2">
<h2 class="anchored" data-anchor-id="time-series">Time Series</h2>
<p>A time series is a sequence of observations taken sequentially in time.</p>
<section id="cross-sectional-data" class="level3">
<h3 class="anchored" data-anchor-id="cross-sectional-data">Cross sectional data</h3>
<p>Observations that come from different individuals or groups at a single point in time.</p>
</section>
<section id="time-series-data" class="level3">
<h3 class="anchored" data-anchor-id="time-series-data">Time series data</h3>
<p>A set of observations, along with some information about what times those observations were recorded.</p>
<hr>
</section>
</section>
<section id="time-series-patterns" class="level1">
<h1>Time Series Patterns</h1>
<hr>
<section id="trend" class="level2">
<h2 class="anchored" data-anchor-id="trend">Trend</h2>
<p>Long-term increase or decrease in the data.</p>
<hr>
</section>
<section id="seasonal" class="level2">
<h2 class="anchored" data-anchor-id="seasonal">Seasonal</h2>
<ul>
<li><p>A seasonal pattern exists when a series is influenced by seasonal factors (e.g., the quarter of the year, the month, or day of the week).</p></li>
<li><p>Seasonality is always of a fixed and known period.</p></li>
</ul>
</section>
<section id="cyclic" class="level2">
<h2 class="anchored" data-anchor-id="cyclic">Cyclic</h2>
<ul>
<li><p>A cyclic pattern exists when data exhibit rises and falls that are not of fixed period.</p></li>
<li><p>The duration of these fluctuations is usually of at least 2 years.</p></li>
<li><p>The average length of cycles is longer than the length of a seasonal pattern.</p></li>
</ul>
<hr>
</section>
<section id="frequency-of-a-time-series-seasonal-periods" class="level2">
<h2 class="anchored" data-anchor-id="frequency-of-a-time-series-seasonal-periods">Frequency of a time series: Seasonal periods</h2>
<p>Frequency: Number of observations per natural time interval (Usually year, but sometimes a week, a day, an hour)</p>
<p>Your turn:</p>
<p>Identify frequencies for the following:</p>
<ul>
<li><p>Annual</p></li>
<li><p>Quarterly</p></li>
<li><p>Monthly</p></li>
<li><p>Weekly</p></li>
</ul>
</section>
<section id="multiple-seasonal-patterns" class="level2">
<h2 class="anchored" data-anchor-id="multiple-seasonal-patterns">Multiple Seasonal Patterns</h2>
<p>For example, the hourly utility demand data exhibit both daily and weekly cycles.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig1.png" class="img-fluid figure-img" width="286"></p>
<figcaption>Source: https://www.robjhyndman.com/papers/multiseasonal.pdf</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="your-turn" class="level2">
<h2 class="anchored" data-anchor-id="your-turn">Your turn</h2>
<p>Identify multiple frequencies for the followings:</p>
<ul>
<li><p>Daily</p></li>
<li><p>Hourly</p></li>
<li><p>Half-hourly</p></li>
<li><p>Minutes</p></li>
<li><p>Seconds</p></li>
</ul>
</section>
</section>
<section id="correlation-vs-autocorrelation" class="level1">
<h1>Correlation vs Autocorrelation</h1>
<section id="correlation" class="level2">
<h2 class="anchored" data-anchor-id="correlation">Correlation</h2>
<ul>
<li>Measures the strength of the linear relationship between two variables</li>
</ul>
<p><span class="math display">\[r = \frac{\sum_{i=1}^{n} (x_i -\bar{x})(y_i-\bar{y})}{\sqrt{\sum_{i=1}^{n} (x_i -\bar{x})^2 \sum_{i=1}^{n} (y_i -\bar{y})^2}}\]</span></p>
</section>
<section id="autocorrelation" class="level2">
<h2 class="anchored" data-anchor-id="autocorrelation">Autocorrelation</h2>
<p>Measures the strength of linear relationship between lagged values of time series.</p>
<p><span class="math display">\[r_k = \frac{\sum (y_t -\bar{y})(y_{t-k}-\bar{y})}{\sum (y_t -\bar{y})^2}\]</span></p>
<p>Lagged values: in-class</p>
</section>
<section id="autocorrelation-plot" class="level2">
<h2 class="anchored" data-anchor-id="autocorrelation-plot">Autocorrelation plot</h2>
<ol type="1">
<li><p>Time series with trend only</p></li>
<li><p>Time series with seasonality only</p></li>
<li><p>Time series with trend and seasonal</p></li>
</ol>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example 1</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-1-cont." class="level2">
<h2 class="anchored" data-anchor-id="example-1-cont.">Example 1 (cont.)</h2>
<p>Seasonal plots</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-1-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1-cont.-1">Example 1 (cont.)</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">Example 2</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-2cont." class="level2">
<h2 class="anchored" data-anchor-id="example-2cont.">Example 2(cont.)</h2>
<p>Seasonal plots</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-2-cont." class="level2">
<h2 class="anchored" data-anchor-id="example-2-cont.">Example 2 (cont.)</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-3" class="level2">
<h2 class="anchored" data-anchor-id="example-3">Example 3</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="example-3-cont" class="level2">
<h2 class="anchored" data-anchor-id="example-3-cont">Example 3 (cont)</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<p>Question 6 at <a href="https://otexts.com/fpp2/graphics-exercises.html" class="uri">https://otexts.com/fpp2/graphics-exercises.html</a></p>
</section>
<section id="notation" class="level2">
<h2 class="anchored" data-anchor-id="notation">Notation</h2>
<p><span class="math display">\[\hat{Y}_{T+h|T}\]</span></p>
</section>
<section id="simple-time-series-forecasting-techniques" class="level2">
<h2 class="anchored" data-anchor-id="simple-time-series-forecasting-techniques">Simple time series forecasting techniques</h2>
<ol type="1">
<li><p>Average method</p></li>
<li><p>Naive method/ random walk method</p></li>
<li><p>Seasonal naive method</p></li>
<li><p>Drift method</p></li>
</ol>
<p><a href="https://otexts.com/fpp2/simple-methods.html">Reading</a></p>
<hr>
</section>
<section id="electricity-demand" class="level2">
<h2 class="anchored" data-anchor-id="electricity-demand">Electricity Demand</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov   Dec
1980  7366  7414  7824  7524  8279  8707  9486  8973  8231  8206  7927  7999
1981  7834  7521  8284  7999  8940  9381 10078  9796  8471  8572  8150  8168
1982  8166  7903  8606  8071  9178  9873 10476  9296  8818  8697  8381  8293
1983  7942  8001  8744  8397  9115  9773 10358  9849  9083  9143  8800  8741
1984  8492  8795  9354  8796 10072 10174 11326 10744  9806  9740  9373  9244
1985  9407  8827  9880  9364 10580 10899 11687 11280 10208 10212  9725  9721
1986  9846  9407 10265  9970 10801 11246 12167 11578 10645 10613 10104 10348
1987 10263  9973 10803 10409 11458 11845 12559 12070 11221 11338 10761 11012
1988 10923 10790 11427 10788 11772 12104 12634 12772 11764 11956 11646 11750
1989 11485 11198 12265 11704 12419 13259 13945 13839 12387 12546 12038 11977
1990 12336 11793 12877 11923 13306 13988 14002 14336 12867 12721 12449 12686
1991 12810 12015 12888 12431 13499 13014 14296 14125 12817 12862 12449 12489
1992 12621 12380 13023 12302 13339 13825 14428 14151 13355 13094 12656 12435
1993 13287 12434 13209 12817 13746 14259 14590 14354 13254 13464 13302 13456
1994 13171 12517 13489 12509 13785 13921 14603 14749 13540 13457 13243 13590
1995 13487 12776 13812 13032 14268 14473 15359 14457                        </code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<hr>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-revealjs/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="statistical-properties" class="level1">
<h1>Statistical Properties</h1>
<section id="mean-function" class="level2">
<h2 class="anchored" data-anchor-id="mean-function">Mean function</h2>
<p>Let <span class="math inline">\({X_1, X_2, ...}\)</span> be a sequence of time index random variables.</p>
<p>The <strong>mean function</strong> of <span class="math inline">\({X_t}\)</span> is</p>
<p><span class="math display">\[\mu_X(t)=E(X_t).\]</span></p>
</section>
<section id="covariance-function" class="level2">
<h2 class="anchored" data-anchor-id="covariance-function">Covariance function</h2>
<p>The <strong>covariance function</strong> of <span class="math inline">\({X_t}\)</span> is</p>
<p><span class="math display">\[\gamma_X(r, s)=Cov(X_r, X_s)=E[(X_r-\mu_X(r))(X_s-\mu_X(s))]\]</span></p>
<p>for all integers <span class="math inline">\((r)\)</span> and <span class="math inline">\((s)\)</span>.</p>
<p>The covariance function of <span class="math inline">\({X_t}\)</span> at lag <span class="math inline">\((h)\)</span> is defined by <span class="math display">\[\gamma_X(h):=\gamma_X(h, 0)=\gamma(t+h, t)=Cov(X_{t+h}, X_t).\]</span></p>
<hr>
</section>
<section id="autocovariance-function" class="level2">
<h2 class="anchored" data-anchor-id="autocovariance-function">Autocovariance function</h2>
<p>The auto covariance function of <span class="math inline">\({X_t}\)</span> at lag <span class="math inline">\((h)\)</span> is</p>
<p><span class="math display">\[\gamma_X(h)=Cov(X_{t+h}, X_t).\]</span> <strong>Autocorrelation function</strong></p>
<p>The autocorrelation function of <span class="math inline">\({X_t}\)</span> at lag <span class="math inline">\((h)\)</span> is</p>
<p><span class="math display">\[\rho_X(h)=\frac{\gamma_X(h)}{\gamma_X(0)}=Cor(X_{t+h}, X_t).\]</span></p>
</section>
<section id="weekly-stationary" class="level2">
<h2 class="anchored" data-anchor-id="weekly-stationary">Weekly stationary</h2>
<p>A time series <span class="math inline">\({X_t}\)</span> is called weekly stationary if</p>
<ul>
<li><p><span class="math inline">\(\mu_X(t)\)</span> is independent of <span class="math inline">\(t\)</span>.</p></li>
<li><p><span class="math inline">\(\gamma_X(t+h, t)\)</span> is independent of <span class="math inline">\((t)\)</span> for each <span class="math inline">\((h)\)</span>.</p></li>
</ul>
<p>In other words the statistical properties of the time series (mean, variance, autocorrelation, etc.) do not depend on the time at which the series is observed, that is no trend or seasonality. However, a time series with cyclic behaviour (but with no trend or seasonality) is stationary.</p>
</section>
<section id="strict-stationarity-of-a-time-series" class="level2">
<h2 class="anchored" data-anchor-id="strict-stationarity-of-a-time-series">Strict stationarity of a time series</h2>
<p>A time series <span class="math inline">\(\{X_t\}\)</span> is called weekly stationary if the random vector <span class="math inline">\([X_1, X_2..., X_n]\)</span> and <span class="math inline">\([X_{1+h}, X_{2+h}..., X_{n+h}]\)</span> have the same joint distribution for all integers <span class="math inline">\((h)\)</span> and <span class="math inline">\((n &gt; 0)\)</span>.</p>
</section>
</section>
<section id="simple-time-series-models" class="level1">
<h1>Simple time series models</h1>
<section id="iid-noise" class="level2">
<h2 class="anchored" data-anchor-id="iid-noise">1. iid noise</h2>
<ol type="1">
<li><p>no trend or seasonal component</p></li>
<li><p>observations are independent and identically distributed (iid) random variables with zero mean.</p></li>
<li><p>Notation: <span class="math inline">\({X_t} \sim IID(0, \sigma^2)\)</span></p></li>
<li><p>plays an important role as a building block for more complicated time series.</p></li>
</ol>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> numpy.random.normal(mean, std, size<span class="op">=</span>num_samples)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="level2">
<h2 class="anchored" data-anchor-id="section-1"></h2>
</section>
<section id="white-noise" class="level2">
<h2 class="anchored" data-anchor-id="white-noise">2. White noise</h2>
<p>If <span class="math inline">\({X_t}\)</span> is a sequence of uncorrelated random variables, each with zero mean and variance <span class="math inline">\(\sigma^2\)</span>, then such a sequence is referred to as <strong>white noise</strong>.</p>
<p>Note: Every <span class="math inline">\((IID(0, \sigma^2)\)</span> sequence is <span class="math inline">\((WN(0, \sigma^2)\)</span> but not conversely.</p>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<div class="cell fig-column-margin">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>std <span class="op">=</span> <span class="dv">1</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>num_samples <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> numpy.random.normal(mean, std, size<span class="op">=</span>num_samples)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.plot(samples)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="acf" class="level2">
<h2 class="anchored" data-anchor-id="acf">ACF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>plot_acf(samples, lags<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>White noise implies stationarity. Stationarity does not imply white noise.</p>
</section>
<section id="random-walk" class="level2">
<h2 class="anchored" data-anchor-id="random-walk">3. Random walk</h2>
<p>A random walk process is obtained by cumulatively summing iid random variables. If <span class="math inline">\({S_t, t=0, 1, 2, ...}\)</span> is a random walk process, then <span class="math inline">\(S_0 =0\)</span></p>
<p><span class="math inline">\(S_1=0+X_1\)</span></p>
<p><span class="math inline">\(S_2=0+X_1+X_2\)</span></p>
<p><span class="math inline">\(...\)</span></p>
<p><span class="math inline">\(S_t=X_1+X_2+...+X_t.\)</span></p>
</section>
<section id="question" class="level2">
<h2 class="anchored" data-anchor-id="question">Question</h2>
<p>Is <span class="math inline">\({S_t, t=0, 1, 2, ...}\)</span> a weak stationary process?</p>
</section>
<section id="identifying-non-stationarity-in-the-mean" class="level2">
<h2 class="anchored" data-anchor-id="identifying-non-stationarity-in-the-mean">Identifying non-stationarity in the mean</h2>
<ul>
<li><p>Using time series plot</p></li>
<li><p>ACF plot</p>
<ul>
<li><p>ACF of stationary time series will drop to relatively quickly.</p></li>
<li><p>The ACF of non-stationary series decreases slowly.</p></li>
<li><p>For non-stationary series, the ACF at lag 1 is often large and positive.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="elimination-of-trend-and-seasonality-by-differencing" class="level1">
<h1>Elimination of Trend and Seasonality by Differencing</h1>
<ul>
<li>Differencing helps to stabilize the mean.</li>
</ul>
<section id="backshift-notation" class="level2">
<h2 class="anchored" data-anchor-id="backshift-notation">Backshift notation:</h2>
<p><span class="math display">\[BX_t=X_{t-1}\]</span></p>
</section>
<section id="ordinary-differencing" class="level2">
<h2 class="anchored" data-anchor-id="ordinary-differencing">Ordinary differencing</h2>
<p>The first-order differencing can be defined as</p>
<p><span class="math display">\[\nabla X_t = X_t-X_{t-1}=X_t-BX_t=(1-B)X_t\]</span> where <span class="math inline">\(\nabla=1-B\)</span>.</p>
<p>The second-order differencing</p>
<p><span class="math display">\[\nabla^2X_t=\nabla(\nabla X_t)=\nabla(X_t-X_{t-1})=\nabla X_t - \nabla X_{t-1}\]</span></p>
<p><span class="math display">\[\nabla X_t - \nabla X_{t-1}=(X_t-X_{t-1})-(X_{t-1}-X_{t-2})\]</span> - In practice, we seldom need to go beyond second order differencing.</p>
</section>
<section id="seasonal-differencing" class="level2">
<h2 class="anchored" data-anchor-id="seasonal-differencing">Seasonal differencing</h2>
<ul>
<li>differencing between an observation and the corresponding observation from the previous year.</li>
</ul>
<p><span class="math display">\[\nabla_mX_t=X_t-X_{t-m}=(1-B^m)X_t\]</span> where <span class="math inline">\((m)\)</span> is the number of seasons. For monthly, <span class="math inline">\((m=12)\)</span>, for quarterly <span class="math inline">\((m=4)\)</span>.</p>
<p>For monthly series</p>
<p><span class="math display">\[\nabla_{12}X_t=X_t-X_{t-12}\]</span></p>
</section>
<section id="section-3" class="level2">
<h2 class="anchored" data-anchor-id="section-3"></h2>
<p>Twice-differenced series</p>
<p><span class="math display">\[\nabla^2_{12}X_t=\nabla_{12}X_t-\nabla_{12}X_{t-1}\]</span> <span class="math display">\[\nabla_{12}X_t-\nabla_{12}X_{t-1}=(X_t-X_{t-12})-(X_{t-1}-X_{t-13})\]</span> If seasonality is strong, the seasonal differencing should be done first.</p>
</section>
<section id="non-stationary-time-series" class="level2">
<h2 class="anchored" data-anchor-id="non-stationary-time-series">Non-Stationary Time Series</h2>
<p><strong>1. Deterministic trend</strong></p>
<p><span class="math display">\[Y_t  = f(t) + \epsilon_t\]</span></p>
<p>where <span class="math inline">\(\epsilon_t \sim iid(0, \sigma^2)\)</span>, <span class="math inline">\(t = 1, 2, ...T\)</span></p>
<p>Mean of the process is time dependent, but the variance of the process is constant.</p>
<p>A trend is deterministic if it is a nonrandom function of time.</p>
</section>
<section id="non-stationary-time-series-cont." class="level2">
<h2 class="anchored" data-anchor-id="non-stationary-time-series-cont.">Non-Stationary Time Series (cont.)</h2>
<p><strong>2. Random walk</strong></p>
<p><span class="math display">\[Y_t = Y_{t-1} + \epsilon_t\]</span></p>
<ul>
<li><p>Random walk has a stochastic trend.</p></li>
<li><p>Model behind naive method.</p></li>
</ul>
<p>A trend is said to be stochastic if it is a random function of time.</p>
</section>
<section id="non-stationary-time-series-cont.-1" class="level2">
<h2 class="anchored" data-anchor-id="non-stationary-time-series-cont.-1">Non-Stationary Time Series (cont.)</h2>
<p><strong>3. Random walk with drift</strong></p>
<p><span class="math display">\[Y_t = \alpha+  Y_{t-1} + \epsilon_t\]</span></p>
<ul>
<li><p>Random walk with drift has a stochastic trend and a deterministic trend.</p></li>
<li><p>Model behind drift method.</p></li>
</ul>
</section>
<section id="random-walk-1" class="level2">
<h2 class="anchored" data-anchor-id="random-walk-1">Random walk</h2>
<p><span class="math display">\[
\begin{aligned}
  Y_t &amp;= Y_{t-1} + \epsilon_t \\
     Y_1    &amp;= Y_0 + \epsilon_1 \\
         Y_2 &amp;=  Y_1 + \epsilon_2=Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &amp;=  Y_2 + \epsilon_3=Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &amp;=Y_{t-1} + \epsilon_t=Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t = Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
\]</span></p>
<p>Mean: <span class="math inline">\(E(Y_t) = Y_0\)</span>.</p>
<p>Variance: <span class="math inline">\(Var(Y_t)=t \sigma^2\)</span>.</p>
</section>
<section id="random-walk-with-drift" class="level2">
<h2 class="anchored" data-anchor-id="random-walk-with-drift">Random walk with drift</h2>
<p><span class="math display">\[
\begin{aligned}
  Y_t &amp;= Y_{t-1} + \epsilon_t \\
     Y_1    &amp;= \alpha+Y_0 + \epsilon_1 \\
         Y_2 &amp;= \alpha+ Y_1 + \epsilon_2=2 \alpha+Y_0 + \epsilon_1 + \epsilon_2\\
          Y_3 &amp;= \alpha+ Y_2 + \epsilon_3= 3 \alpha+ Y_0 + \epsilon_1 + \epsilon_2 +\epsilon_3\\
          .   \\
          Y_t &amp;= \alpha+Y_{t-1} + \epsilon_t= t \alpha+ Y_0 + \epsilon_1 + \epsilon_2 + \epsilon_3 +...+ \epsilon_t \\
          Y_t &amp;= t \alpha + Y_0 + \sum_{i=1}^{t} \epsilon_t
\end{aligned}
\]</span></p>
</section>
<section id="random-walk-with-drift-cont." class="level2">
<h2 class="anchored" data-anchor-id="random-walk-with-drift-cont.">Random walk with drift (cont.)</h2>
<p>It has a <em>deterministic trend</em> <span class="math inline">\((Y_0 + t \alpha)\)</span> and a <em>stochastic trend</em> <span class="math inline">\(\sum_{i=1}^{t} \epsilon_t\)</span>.</p>
<p>Mean: <span class="math inline">\(E(Y_t) = Y_0 + t\alpha\)</span></p>
<p>Variance: <span class="math inline">\(Var(Y_t) = t\sigma^2\)</span>.</p>
<p>There is a trend in both mean and variance.</p>
</section>
<section id="common-trend-removal-de-trending-procedures" class="level2">
<h2 class="anchored" data-anchor-id="common-trend-removal-de-trending-procedures">Common trend removal (de-trending) procedures</h2>
<ol type="1">
<li><p>Deterministic trend: Time-trend regression</p>
<p>The trend can be removed by fitting a deterministic polynomial time trend. The residual series after removing the trend will give us the de-trended series.</p></li>
<li><p>Stochastic trend: Differencing</p>
<p>The process is also known as a <strong>Difference-stationary process</strong>.</p></li>
</ol>
</section>
</section>
<section id="notation-id" class="level1">
<h1>Notation: I(d)</h1>
<p>Integrated to order <span class="math inline">\(d\)</span>: Series can be made stationary by differencing <span class="math inline">\(d\)</span> times.</p>
<ul>
<li>Known as <span class="math inline">\(I(d)\)</span> process.</li>
</ul>
<p><strong>Question:</strong> Show that random walk process is an <span class="math inline">\(I(1)\)</span> process.</p>
<p>The random walk process is called a unit root process. (If one of the roots turns out to be one, then the process is called unit root process.)</p>
<section id="random-walk-2" class="level2">
<h2 class="anchored" data-anchor-id="random-walk-2">Random walk</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rw <span class="op">=</span> np.cumsum(samples)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.plot(rw)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-walk---acf" class="level2">
<h2 class="anchored" data-anchor-id="random-walk---acf">Random walk - ACF</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot_acf(rw, lags<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="difference-series" class="level2">
<h2 class="anchored" data-anchor-id="difference-series">Difference series</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(rw, columns <span class="op">=</span> [<span class="st">'Values'</span>])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Lag 1'</span>] <span class="op">=</span> df[<span class="st">'Values'</span>].diff()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Lag 2'</span>] <span class="op">=</span> df[<span class="st">'Values'</span>].diff().diff()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-lag-1-series" class="level2">
<h2 class="anchored" data-anchor-id="plot-lag-1-series">Plot Lag 1 series</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plt.plot(df[<span class="st">'Values'</span>].diff())</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="acf-lag-1-series" class="level2">
<h2 class="anchored" data-anchor-id="acf-lag-1-series">ACF Lag 1 series</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>diff <span class="op">=</span> df[<span class="st">'Lag 1'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plot_acf(diff.dropna(), lags<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-2-1" class="level2">
<h2 class="anchored" data-anchor-id="example-2-1">Example 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf, plot_pacf</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'figure.figsize'</span>:(<span class="dv">9</span>,<span class="dv">7</span>), <span class="st">'figure.dpi'</span>:<span class="dv">120</span>})</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'wwwusage.csv'</span>, names<span class="op">=</span>[<span class="st">'value'</span>], header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Series</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(df.value)<span class="op">;</span> axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Original Series'</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>plot_acf(df.value, ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], lags<span class="op">=</span>np.arange(<span class="bu">len</span>(df)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st Differencing</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(df.value.diff())<span class="op">;</span> axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'1st Order Differencing'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>plot_acf(df.value.diff().dropna(), ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], lags<span class="op">=</span>np.arange(<span class="bu">len</span>(df) <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-4" class="level2">
<h2 class="anchored" data-anchor-id="section-4"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np, pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.graphics.tsaplots <span class="im">import</span> plot_acf, plot_pacf</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update({<span class="st">'figure.figsize'</span>:(<span class="dv">9</span>,<span class="dv">7</span>), <span class="st">'figure.dpi'</span>:<span class="dv">120</span>})</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'wwwusage.csv'</span>, names<span class="op">=</span>[<span class="st">'value'</span>], header<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Original Series</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>, <span class="dv">0</span>].plot(df.value)<span class="op">;</span> axes[<span class="dv">0</span>, <span class="dv">0</span>].set_title(<span class="st">'Original Series'</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>plot_acf(df.value, ax<span class="op">=</span>axes[<span class="dv">0</span>, <span class="dv">1</span>], lags<span class="op">=</span>np.arange(<span class="bu">len</span>(df)))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st Differencing</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>, <span class="dv">0</span>].plot(df.value.diff())<span class="op">;</span> axes[<span class="dv">1</span>, <span class="dv">0</span>].set_title(<span class="st">'1st Order Differencing'</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>plot_acf(df.value.diff().dropna(), ax<span class="op">=</span>axes[<span class="dv">1</span>, <span class="dv">1</span>], lags<span class="op">=</span>np.arange(<span class="bu">len</span>(df) <span class="op">-</span> <span class="dv">1</span>))</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="nd-order-differencing" class="level2">
<h2 class="anchored" data-anchor-id="nd-order-differencing">2nd order differencing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot_acf(df.value.diff().diff().dropna())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variance-stabilization" class="level2">
<h2 class="anchored" data-anchor-id="variance-stabilization">Variance stabilization</h2>
<p>Eg:</p>
<ul>
<li><p>Square root: <span class="math inline">\(W_t = \sqrt{Y_t}\)</span></p></li>
<li><p>Logarithm: <span class="math inline">\(W_t = log({Y_t})\)</span></p>
<ul>
<li><p>This very useful.</p></li>
<li><p>Interpretable: Changes in a log value are <strong>relative (percent) changes on the original sclae</strong>.</p></li>
</ul></li>
</ul>
</section>
<section id="monthly-airline-passenger-numbers-1949-1960" class="level2">
<h2 class="anchored" data-anchor-id="monthly-airline-passenger-numbers-1949-1960">Monthly Airline Passenger Numbers 1949-1960</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>airpassenger <span class="op">=</span> pd.read_csv(<span class="st">'AirPassengers.csv'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>airpassenger[<span class="st">'Month'</span>]<span class="op">=</span> pd.to_datetime(airpassenger[<span class="st">'Month'</span>])</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>ggplot(airpassenger, aes(x<span class="op">=</span><span class="st">'Month'</span>, y<span class="op">=</span><span class="st">'#Passengers'</span>))<span class="op">+</span>geom_line()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="monthly-airline-passenger-numbers-1949-1960---log" class="level2">
<h2 class="anchored" data-anchor-id="monthly-airline-passenger-numbers-1949-1960---log">Monthly Airline Passenger Numbers 1949-1960 - log</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>airpassenger[<span class="st">'naturallog'</span>] <span class="op">=</span> np.log(airpassenger[<span class="st">'#Passengers'</span>]) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ggplot(airpassenger, aes(x<span class="op">=</span><span class="st">'Month'</span>, y<span class="op">=</span><span class="st">'naturallog'</span>))<span class="op">+</span>geom_line()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-cox-transformation" class="level2">
<h2 class="anchored" data-anchor-id="box-cox-transformation">Box-Cox transformation</h2>
<p><span class="math display">\[
  w_t=\begin{cases}
    log(y_t), &amp; \text{if $\lambda=0$} \newline
    (Y_t^\lambda - 1)/ \lambda, &amp; \text{otherwise}.
  \end{cases}
\]</span></p>
<p>Different values of <span class="math inline">\(\lambda\)</span> gives you different transformations.</p>
<ul>
<li><p><span class="math inline">\(\lambda=1\)</span>: No <strong>substantive</strong> transformation</p></li>
<li><p><span class="math inline">\(\lambda = \frac{1}{2}\)</span>: Square root plus linear transformation</p></li>
<li><p><span class="math inline">\(\lambda=0\)</span>: Natural logarithm</p></li>
<li><p><span class="math inline">\(\lambda = -1\)</span>: Inverse plus 1</p></li>
</ul>
<p>Balance the seasonal fluctuations and random variation across the series.</p>
</section>
<section id="box-cox-transformation-1" class="level2">
<h2 class="anchored" data-anchor-id="box-cox-transformation-1">Box-Cox transformation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import modules</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>y2,fitted_lambda <span class="op">=</span> stats.boxcox(airpassenger[<span class="st">'#Passengers'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="box-cox-transformation-exploring-the-output" class="level2">
<h2 class="anchored" data-anchor-id="box-cox-transformation-exploring-the-output">Box-Cox transformation: Exploring the output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fitted_lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>y2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="linear-time-series-analysis" class="level1">
<h1>Linear Time Series Analysis</h1>
<section id="autoregressive-models" class="level2">
<h2 class="anchored" data-anchor-id="autoregressive-models">Autoregressive Models</h2>
<p><span class="math inline">\(Y_t = \alpha + \phi_1 Y_{t-1} + \phi_2 Y_{t-2} + \dots + \phi_p Y_{t-p} + \epsilon_t\)</span></p>
<p>Where:</p>
<p><span class="math inline">\(Y_t\)</span> is the value at time <span class="math inline">\(t\)</span></p>
<p><span class="math inline">\(\alpha\)</span> is a constant,</p>
<p><span class="math inline">\(\phi_1, \phi_2,...\phi_p\)</span> are the parameters,</p>
<p><span class="math inline">\(\epsilon_t\)</span> is white noise (error term),</p>
<p><span class="math inline">\(p\)</span> is the order of the AR model.</p>
</section>
<section id="in-class-properties-of-ar1-process" class="level2">
<h2 class="anchored" data-anchor-id="in-class-properties-of-ar1-process">In-class: Properties of AR(1) process</h2>
<p>Derive</p>
<ul>
<li><p>Mean</p></li>
<li><p>Variance</p></li>
<li><p>Covariance</p></li>
<li><p>Autocorrelation function of an AR(1) process</p></li>
</ul>
</section>
<section id="in-class-properties-of-ar2-process" class="level2">
<h2 class="anchored" data-anchor-id="in-class-properties-of-ar2-process">In-class: Properties of AR(2) process</h2>
<p>Derive</p>
<ul>
<li><p>Mean</p></li>
<li><p>Variance</p></li>
<li><p>Covariance</p></li>
<li><p>Autocorrelation function of an AR(1) process</p></li>
</ul>
</section>
<section id="in-class-properties-of-arp-process" class="level2">
<h2 class="anchored" data-anchor-id="in-class-properties-of-arp-process">In-class: Properties of AR(P) process</h2>
<p>Derive</p>
<ul>
<li><p>Mean</p></li>
<li><p>Variance</p></li>
<li><p>Covariance</p></li>
<li><p>Autocorrelation function of an AR(P) process</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->


<script>

  // htmlwidgets need to know to resize themselves when slides are shown/hidden.

  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

  // slide changes (different for each slide format).

  (function () {

    // dispatch for htmlwidgets

    function fireSlideEnter() {

      const event = window.document.createEvent("Event");

      event.initEvent("slideenter", true, true);

      window.document.dispatchEvent(event);

    }



    function fireSlideChanged(previousSlide, currentSlide) {

      fireSlideEnter();



      // dispatch for shiny

      if (window.jQuery) {

        if (previousSlide) {

          window.jQuery(previousSlide).trigger("hidden");

        }

        if (currentSlide) {

          window.jQuery(currentSlide).trigger("shown");

        }

      }

    }



    // hookup for slidy

    if (window.w3c_slidy) {

      window.w3c_slidy.add_observer(function (slide_num) {

        // slide_num starts at position 1

        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

      });

    }



  })();

</script>



<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>